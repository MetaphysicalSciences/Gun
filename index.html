<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Doom-style 3D Game</title>
<style>
html,body{margin:0;padding:0;width:100%;height:100%;overflow:hidden;background:#000;font-family:sans-serif}
#ui{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none}
#menu,#settings{position:absolute;width:100%;height:100%;background:rgba(0,0,0,0.9);display:flex;flex-direction:column;justify-content:center;align-items:center;pointer-events:auto}
button{padding:12px 28px;margin:10px;font-size:18px;border-radius:10px;background:#222;color:#fff;border:none;cursor:pointer}
button:active{transform:translateY(1px)}
#canvas-container{width:100%;height:100%}
</style>
</head>
<body>
<div id="canvas-container"></div>
<div id="ui">
  <div id="menu">
    <h1 style="color:#fff;font-size:36px;margin-bottom:40px">Doom-style Game</h1>
    <button id="startBtn">Start Game</button>
    <button id="settingsBtn">Settings</button>
  </div>
  <div id="settings" style="display:none;flex-direction:column;">
    <h2 style="color:#fff;margin-bottom:20px">Settings</h2>
    <label style="color:#fff;margin-bottom:20px"><input type="checkbox" id="mobileToggle"> Mobile Controls</label>
    <button id="backBtn">Back</button>
  </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.min.js"></script>
<script>
let scene,camera,renderer,player;
let animationPlaying=false;
let mobileEnabled=false;

function init3D(){
  const container=document.getElementById("canvas-container");
  scene=new THREE.Scene();
  scene.background=new THREE.Color(0x222222);
  camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,0.1,1000);
  renderer=new THREE.WebGLRenderer({antialias:true});
  renderer.setSize(window.innerWidth,window.innerHeight);
  container.appendChild(renderer.domElement);

  // floor
  const floorGeo=new THREE.PlaneGeometry(50,50);
  const floorMat=new THREE.MeshBasicMaterial({color:0x444444});
  const floor=new THREE.Mesh(floorGeo,floorMat);
  floor.rotation.x=-Math.PI/2;
  scene.add(floor);

  // player plane for sprite animations
  const texLoader=new THREE.TextureLoader();
  const startTex=texLoader.load('AUEPA0.png');
  const planeGeo=new THREE.PlaneGeometry(2,2);
  const planeMat=new THREE.MeshBasicMaterial({map:startTex,transparent:true});
  player=new THREE.Mesh(planeGeo,planeMat);
  player.position.set(0,1,0);
  scene.add(player);

  camera.position.set(0,2,5);

  animate();
}

function animate(){
  requestAnimationFrame(animate);
  renderer.render(scene,camera);
}

const reloadSeq=["AUMRB0.png","AUMRC0.png","AUMRD0.png","AUMRE0.png","AUMRF0.png","AUMRG0.png","AUMRH0.png","AUMRI0.png","AUMRJ0.png","AUMRK0.png","AUMRL0.png"];
const shootSeq=["AUMPD0.png","AUMPE0.png","AUMPF0.png","AUMFB0.png","AUMFA0.png","AUMPG0.png","AUMRA0.png","AUMPF0.png"];

function playAnimation(seq,endImage){
  if(animationPlaying) return;
  animationPlaying=true;
  let idx=0;
  const texLoader=new THREE.TextureLoader();
  const interval=setInterval(()=>{
    const tex=texLoader.load(seq[idx]);
    player.material.map=tex;
    idx++;
    if(idx>=seq.length){
      clearInterval(interval);
      if(endImage)player.material.map=texLoader.load(endImage);
      animationPlaying=false;
    }
  },150);
}

document.getElementById("startBtn").addEventListener("click",()=>{
  document.getElementById("menu").style.display="none";
  init3D();
});
document.getElementById("settingsBtn").addEventListener("click",()=>{
  document.getElementById("menu").style.display="none";
  document.getElementById("settings").style.display="flex";
});
document.getElementById("backBtn").addEventListener("click",()=>{
  document.getElementById("settings").style.display="none";
  document.getElementById("menu").style.display="flex";
});
document.getElementById("mobileToggle").addEventListener("change",(e)=>{
  mobileEnabled=e.target.checked;
});

// keyboard controls
window.addEventListener("keydown",e=>{
  if(e.key==="r") playAnimation(reloadSeq,"AUEPA0.png");
  if(e.key==="f") playAnimation(shootSeq,null);
});

// resize
window.addEventListener("resize",()=>{camera.aspect=window.innerWidth/window.innerHeight;camera.updateProjectionMatrix();renderer.setSize(window.innerWidth,window.innerHeight);});
</script>
</body>
</html>
