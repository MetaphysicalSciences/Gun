<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Doom 2D Shooter</title>
<style>
html,body{margin:0;padding:0;width:100%;height:100%;overflow:hidden;background:#000;color:#fff;font-family:sans-serif}
#menu,#settings{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;background:#111;gap:20px;z-index:10}
button{padding:12px 30px;font-size:20px;border:none;border-radius:12px;background:#222;color:#fff;cursor:pointer;touch-action:manipulation}
button:active{transform:translateY(1px)}
#gameCanvas{display:block;width:100%;height:100%;background:#000}
#mobileControls{position:absolute;bottom:20px;left:50%;transform:translateX(-50%);display:flex;gap:15px;z-index:5}
.mobileBtn{padding:15px 20px;border-radius:12px;background:#444;color:#fff;font-size:18px;touch-action:manipulation;user-select:none}
</style>
</head>
<body>
<div id="menu">
  <h1>Doom 2D Shooter</h1>
  <button id="startBtn">Start Game</button>
  <button id="settingsBtn">Settings</button>
</div>
<div id="settings">
  <h2>Settings</h2>
  <label><input type="checkbox" id="toggleMobile"> Enable Mobile Buttons</label>
  <button id="backBtn">Back</button>
</div>
<canvas id="gameCanvas"></canvas>
<div id="mobileControls">
  <div class="mobileBtn" id="upBtn">↑</div>
  <div class="mobileBtn" id="leftBtn">←</div>
  <div class="mobileBtn" id="shootBtn">Shoot</div>
  <div class="mobileBtn" id="rightBtn">→</div>
  <div class="mobileBtn" id="downBtn">↓</div>
</div>
<script>
const canvas=document.getElementById('gameCanvas'),ctx=canvas.getContext('2d');
let width=canvas.width=window.innerWidth,height=canvas.height=window.innerHeight;

let menu=document.getElementById('menu');
let settings=document.getElementById('settings');
let mobileControls=document.getElementById('mobileControls');
let mobileEnabled=false;

document.getElementById('startBtn').addEventListener('click',()=>{menu.style.display='none';startGame();});
document.getElementById('settingsBtn').addEventListener('click',()=>{menu.style.display='none';settings.style.display='flex';});
document.getElementById('backBtn').addEventListener('click',()=>{settings.style.display='none';menu.style.display='flex';});
document.getElementById('toggleMobile').addEventListener('change',e=>{mobileEnabled=e.target.checked;mobileControls.style.display=mobileEnabled?'flex':'none';});

window.addEventListener('resize',()=>{width=canvas.width=window.innerWidth;height=canvas.height=window.innerHeight;});

let keys={};
window.addEventListener('keydown',e=>{keys[e.key.toLowerCase()]=true});
window.addEventListener('keyup',e=>{keys[e.key.toLowerCase()]=false});

// Mobile button events
let mobileKeys={'upBtn':'w','downBtn':'s','leftBtn':'a','rightBtn':'d','shootBtn':' '};
for(let id in mobileKeys){
  let el=document.getElementById(id);
  el.addEventListener('touchstart',e=>{e.preventDefault();keys[mobileKeys[id]]=true});
  el.addEventListener('touchend',e=>{e.preventDefault();keys[mobileKeys[id]]=false});
}

// Player
let player={x:300,y:300,angle:0,moveSpeed:3,rotSpeed:0.05,bullets:[]};
let walls=[{x:100,y:100,w:400,h:20},{x:100,y:100,w:20,h:400},{x:100,y:480,w:400,h:20},{x:480,y:100,w:20,h:400}];

function startGame(){
  mobileControls.style.display=mobileEnabled?'flex':'none';
  requestAnimationFrame(gameLoop);
}

function shootBullet(){
  player.bullets.push({x:player.x,y:player.y,angle:player.angle,speed:8});
}

function gameLoop(){
  ctx.fillStyle="#000";ctx.fillRect(0,0,width,height);

  // Player rotation
  if(keys['a'])player.angle-=player.rotSpeed;
  if(keys['d'])player.angle+=player.rotSpeed;

  // Movement
  let dx=0,dy=0;
  if(keys['w']){dx+=Math.cos(player.angle)*player.moveSpeed;dy+=Math.sin(player.angle)*player.moveSpeed;}
  if(keys['s']){dx-=Math.cos(player.angle)*player.moveSpeed;dy-=Math.sin(player.angle)*player.moveSpeed;}
  // Collision simple
  let newX=player.x+dx,newY=player.y+dy;
  let hit=false;
  for(let w of walls){if(newX>w.x && newX<w.x+w.w && newY>w.y && newY<w.y+w.h)hit=true;}
  if(!hit){player.x=newX;player.y=newY;}

  // Draw walls
  ctx.fillStyle="#888";
  for(let w of walls)ctx.fillRect(w.x,w.y,w.w,w.h);

  // Draw player
  ctx.fillStyle="#0f0";ctx.beginPath();ctx.arc(player.x,player.y,10,0,2*Math.PI);ctx.fill();
  // Draw gun line
  ctx.strokeStyle="#ff0";ctx.beginPath();ctx.moveTo(player.x,player.y);
  ctx.lineTo(player.x+Math.cos(player.angle)*30,player.y+Math.sin(player.angle)*30);ctx.stroke();

  // Bullets
  if(keys[' '])shootBullet();
  for(let i=player.bullets.length-1;i>=0;i--){
    let b=player.bullets[i];
    b.x+=Math.cos(b.angle)*b.speed;b.y+=Math.sin(b.angle)*b.speed;
    ctx.fillStyle="#f00";ctx.beginPath();ctx.arc(b.x,b.y,4,0,2*Math.PI);ctx.fill();
    // Remove bullets if offscreen
    if(b.x<0||b.x>width||b.y<0||b.y>height)player.bullets.splice(i,1);
  }

  requestAnimationFrame(gameLoop);
}
</script>
</body>
</html>
