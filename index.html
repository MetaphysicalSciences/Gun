<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>AUMR Retro Reload</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
html,body{height:100%;width:100%;margin:0;padding:0;overflow:hidden;background:#080808;font-family:'Press Start 2P',monospace;touch-action: manipulation;user-select:none}
*{touch-action:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}
#wrap{height:100%;width:100%;display:flex;flex-direction:column;align-items:center;justify-content:space-between;position:relative}
#top{width:100%;display:flex;justify-content:center;align-items:center;padding:14px 12px;gap:14px}
button{appearance:none;border:0;padding:12px 24px;border-radius:0;font-size:12px;background:#111;color:#fff;cursor:pointer;min-width:80px}
button:disabled{opacity:.45;cursor:not-allowed}
button:active{transform:translateY(1px)}
#imgWrap{display:flex;justify-content:center;align-items:flex-end;width:100%;flex:1;padding-bottom:18px}
#ammo{position:absolute;bottom:12px;right:12px;display:flex;gap:2px;align-items:center}
.capsule{width:42px;height:72px} /* 3x bigger */
img#mainImg{max-width:100%;height:auto;display:block}
@media (max-width:520px){
  button{padding:10px 18px;font-size:10px;min-width:70px}
  .capsule{width:28px;height:48px}
}
</style>
<script>
const reloadSeq=["AUMRB0.png","AUMRC0.png","AUMRD0.png","AUMRE0.png","AUMRF0.png","AUMRG0.png","AUMRH0.png","AUMRI0.png","AUMRJ0.png","AUMRK0.png","AUMRL0.png"];
const emptyReloadSeq=["AUERB0.png","AUERC0.png","AUERD0.png","AUERE0.png","AUERF0.png","AUERG0.png","AUERH0.png","AUERI0.png","AUMPA0.png"];
const shootSeq=["AUMPD0.png","AUMPE0.png","AUMPF0.png","AUMFB0.png","AUMFA0.png","AUMPG0.png","AUMRA0.png","AUMPF0.png"];
const preload=[...reloadSeq,...emptyReloadSeq,...shootSeq,"AUMPA0.png","AUEPA0.png","AUERDbllet.png"];
for(let f of preload){const im=new Image();im.src=f;}

let ammo=7;
let shooting=false;
let reloading=false;

function setImgNow(src){document.getElementById("mainImg").src=src}

function updateCapsules(){
  const container=document.getElementById("ammo");
  container.innerHTML='';
  for(let i=0;i<7;i++){
    const b=document.createElement('img');
    b.src='AUERDbllet.png';
    b.className='capsule';
    b.style.opacity=(i<ammo)?1:0.3;
    container.appendChild(b);
  }
}

function animateReloadBullets(startIndex,count,callback){
  if(count<=0){if(callback)callback();return;}
  const container=document.getElementById("ammo");
  const bullet=container.children[startIndex];
  bullet.style.opacity=1;
  setTimeout(()=>animateReloadBullets(startIndex+1,count-1,callback),100);
}

function playSequence(seq,endImg,doneCallback,speed){
  const el=document.getElementById("mainImg");
  let i=0;
  const t=setInterval(()=>{
    if(i<seq.length){el.src=seq[i];i++}
    if(i>=seq.length){
      clearInterval(t);
      if(endImg)el.src=endImg;
      if(doneCallback)setTimeout(doneCallback,50);
    }
  },speed);
}

function reloadAction(){
  if(reloading||shooting)return;
  reloading=true;
  const reloadBtn=document.getElementById("reloadBtn");
  const shootBtn=document.getElementById("shootBtn");
  reloadBtn.disabled=true;
  shootBtn.disabled=true;
  const emptySlots=7-ammo;
  const seq=(ammo<=0)?emptyReloadSeq:reloadSeq;
  playSequence(seq,"AUMPA0.png",()=>{
    animateReloadBullets(7-emptySlots,emptySlots,()=>{
      ammo=7;
      reloading=false;
      reloadBtn.disabled=false;
      shootBtn.disabled=false;
      setImgNow("AUMPA0.png");
    });
  },140);
}

function shootAction(){
  if(shooting||reloading||ammo<=0)return;
  shooting=true;
  ammo--;
  updateCapsules();
  const shootBtn=document.getElementById("shootBtn");
  shootBtn.disabled=true;
  playSequence(shootSeq,null,()=>{
    shooting=false;
    shootBtn.disabled=false;
    if(ammo<=0){
      setImgNow("AUEPA0.png");
      shootBtn.disabled=true;
    }
  },90);
}

window.addEventListener('keydown',e=>{if(e.key==="F5")e.preventDefault()});
window.addEventListener('dblclick',e=>{e.preventDefault()});
window.addEventListener('touchstart',e=>{if(e.touches.length>1)e.preventDefault();},{passive:false});
document.addEventListener('DOMContentLoaded',()=>{
  updateCapsules();
  document.getElementById("reloadBtn").addEventListener('click',reloadAction);
  document.getElementById("shootBtn").addEventListener('click',shootAction);
});
</script>
</head>
<body>
<div id="wrap">
  <div id="top">
    <button id="reloadBtn" type="button">RELOAD</button>
    <button id="shootBtn" type="button">SHOOT</button>
  </div>
  <div id="imgWrap">
    <img id="mainImg" src="AUEPA0.png" alt="AUEPA0">
  </div>
  <div id="ammo"></div>
</div>
</body>
</html>
